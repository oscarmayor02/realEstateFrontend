<div class="container-fluid px-4">
  <div class="py-4">
    <h2 class="mb-4 fw-bold">Propiedades destacadas</h2>

    <div class="d-flex justify-content-between align-items-center mb-3">
      <!-- Botones del carrusel -->
      <button
        class="carousel-arrow left d-none d-lg-flex"
        (click)="scrollCarousel(-1)"
        aria-label="Anterior"
      >
        <i class="bi bi-chevron-left"></i>
      </button>
      <button
        class="carousel-arrow right d-none d-lg-flex"
        (click)="scrollCarousel(1)"
        aria-label="Siguiente"
      >
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>

    <div class="property-carousel" #carousel>
      <div class="property-track">
        <!-- Tarjetas -->
        <div
          class="property-card"
          *ngFor="let prop of properties; let i = index"
          (click)="verDetalle(prop.id)"
        >
          <div class="property-card-inner">
            <img
              [src]="getCurrentImage(prop, i)"
              alt="Imagen propiedad"
              class="property-img"
            />

            <button
              *ngIf="isLoggedIn()"
              class="favorite-btn"
              (click)="toggleFavorite(prop.id, $event); $event.stopPropagation()"
              aria-label="Agregar a favoritos"
            >
              <i
                class="bi"
                [ngClass]="{
                  'bi-heart-fill text-danger': isFavorite(prop.id),
                  'bi-heart': !isFavorite(prop.id)
                }"
              ></i>
            </button>

            <div class="property-info">
              <h5
                class="fw-semibold mb-1 text-truncate"
                title="{{ prop.title }}"
              >
                {{ prop.title || 'Propiedad en ' + prop.ciudad }}
              </h5>
              <p class="text-muted small mb-2">
                📍 {{ prop.ciudad }}, {{ prop.departamento }}
              </p>

              <div
                class="d-flex justify-content-between align-items-center mb-2"
              >
                <span class="fw-bold text-dark fs-6">
                  ${{ prop.price | number: '1.0-0' }}
                  <small class="text-muted fw-light">
                    {{ prop.type === 'RENT' ? '/mes' : 'COP' }}
                  </small>
                </span>
                <span
                  class="badge rounded-pill small"
                  [ngClass]="{
                    'bg-primary-subtle text-primary': prop.type === 'RENT',
                    'bg-success-subtle text-success': prop.type !== 'RENT'
                  }"
                >
                  {{ prop.type === 'RENT' ? 'Arriendo' : 'Venta' }}
                </span>
              </div>

              <div class="d-flex gap-3 text-muted small mb-2 flex-wrap">
                <span>🛏️ {{ prop.bedrooms }}</span>
                <span>🛁 {{ prop.bathrooms }}</span>
                <span>📐 {{ prop.area }} m²</span>
                <span *ngIf="prop.parkingSpaces > 0">
                  🚗 {{ prop.parkingSpaces }}
                </span>
              </div>

              <div class="d-flex flex-wrap gap-1 mb-2">
                <span
                  *ngIf="prop.petsAllowed"
                  class="badge bg-success-subtle text-success"
                >
                  🐾 Mascotas
                </span>
                <span *ngIf="prop.pool" class="badge bg-info-subtle text-info">
                  🏊 Piscina
                </span>
                <span
                  *ngIf="prop.balcony"
                  class="badge bg-warning-subtle text-warning"
                >
                  🌇 Balcón
                </span>
                <span
                  *ngIf="prop.terrace"
                  class="badge bg-light text-dark border"
                >
                  🌤 Terraza
                </span>
              </div>
            </div>
          </div>
        </div>
        <!-- fin de tarjeta -->
      </div>
    </div>
  </div>
</div>
